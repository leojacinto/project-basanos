constraints:
  - id: discovered:change_freeze
    name: Active Change Freeze (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - resolve
      - close
      - auto_resolve
    severity: block
    description: >-
      Found 10 recent change requests. Incident resolution during active change windows should be blocked. [Evidence: 10
      change requests found in recent history]
    conditions: []
    violationMessage: An active change freeze is in effect. Escalate to change management.
    satisfiedMessage: No active change freeze detected.
  - id: discovered:p1_reassignment
    name: P1 Reassignment Caution (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - reassign
    severity: warn
    description: >-
      0% of active P1 incidents have been reassigned. P1 reassignment disrupts war rooms and escalation chains.
      [Evidence: 50 active P1s, 0 reassigned (0% rate)]
    conditions: []
    violationMessage: This is a P1 incident. Confirm with incident commander before reassigning.
    satisfiedMessage: Standard reassignment procedures apply.
  - id: discovered:group_capacity
    name: Group Capacity Warning (Discovered)
    domain: itsm
    appliesTo:
      - incident
      - problem
      - change_request
    relevantActions:
      - assign
      - reassign
    severity: warn
    description: >-
      2 groups have >20 active tickets. Highest: "Powerkart Support" with 305 tickets. Overloaded groups lead to SLA
      breaches. [Evidence: 2 overloaded groups, max: Powerkart Support (305 tickets)]
    conditions: []
    violationMessage: Target group is overloaded. Consider alternative assignment.
    satisfiedMessage: Group capacity is within acceptable range.
  - id: discovered:sla_breach
    name: SLA Breach Review (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - close
    severity: warn
    description: >-
      Found 100 breached SLA records. Incidents with breached SLAs should be reviewed before closure. [Evidence: 100
      breached SLA records found]
    conditions: []
    violationMessage: This incident breached an SLA. Review required before closing.
    satisfiedMessage: No SLA breach detected.
