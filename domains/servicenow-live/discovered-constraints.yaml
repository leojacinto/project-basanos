constraints:
  - id: servicenow-live:discovered:change_freeze
    name: Active Change Freeze (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
    relevantActions:
      - resolve
      - close
      - auto_resolve
    severity: block
    status: candidate
    description: >-
      Found 10 recent change requests. Incident resolution during active change windows should be blocked. [Evidence: 10
      change requests found in recent history]
    conditions: []
    violationMessage: An active change freeze is in effect. Escalate to change management.
    satisfiedMessage: No active change freeze detected.
  - id: servicenow-live:discovered:p1_reassignment
    name: P1 Reassignment Caution (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
    relevantActions:
      - reassign
    severity: warn
    status: candidate
    description: >-
      0% of active P1 incidents have been reassigned. P1 reassignment disrupts war rooms and escalation chains.
      [Evidence: 50 active P1s, 0 reassigned (0% rate)]
    conditions: []
    violationMessage: This is a P1 incident. Confirm with incident commander before reassigning.
    satisfiedMessage: Standard reassignment procedures apply.
  - id: servicenow-live:discovered:group_capacity
    name: Group Capacity Warning (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
      - problem
      - change_request
    relevantActions:
      - assign
      - reassign
    severity: warn
    status: candidate
    description: >-
      2 groups have >20 active tickets. Highest: "Powerkart Support" with 305 tickets. Overloaded groups lead to SLA
      breaches. [Evidence: 2 overloaded groups, max: Powerkart Support (305 tickets)]
    conditions: []
    violationMessage: Target group is overloaded. Consider alternative assignment.
    satisfiedMessage: Group capacity is within acceptable range.
  - id: servicenow-live:discovered:sla_breach
    name: SLA Breach Review (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
    relevantActions:
      - close
    severity: warn
    status: candidate
    description: >-
      Found 100 breached SLA records. Incidents with breached SLAs should be reviewed before closure. [Evidence: 100
      breached SLA records found]
    conditions: []
    violationMessage: This incident breached an SLA. Review required before closing.
    satisfiedMessage: No SLA breach detected.
  - id: servicenow-live:discovered:unassigned_high_priority
    name: Unassigned High Priority Incidents (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
    relevantActions:
      - assign
      - auto_resolve
    severity: warn
    status: candidate
    description: >-
      Found 17 P1/P2 incidents without a named assignee. High priority incidents need individual ownership, not just
      group assignment. [Evidence: 17 of 50 active P1/P2 incidents are unassigned]
    conditions: []
    violationMessage: Unassigned high priority incidents exist. Ensure a named owner before taking action.
    satisfiedMessage: All high priority incidents have assigned owners.
  - id: servicenow-live:discovered:major_incident_no_problem
    name: Major Incident Without Problem Record (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
      - problem
    relevantActions:
      - close
    severity: warn
    status: candidate
    description: >-
      Found 25 resolved/closed P1 incidents without a linked problem record. Major incidents should trigger problem
      management for root cause analysis. [Evidence: 25 resolved P1s without problem records]
    conditions: []
    violationMessage: This major incident has no linked problem record. Create a problem for root cause analysis.
    satisfiedMessage: Problem record exists for root cause tracking.
  - id: servicenow-live:discovered:recurring_ci_failures
    name: Recurring CI Failures (Discovered)
    domain: servicenow-live
    appliesTo:
      - incident
      - change_request
    relevantActions:
      - assign
      - resolve
    severity: warn
    status: candidate
    description: >-
      13 CIs have >3 active incidents. Worst: "Impact Calculation" with 212 incidents. Systemic instability needs
      problem management investigation. [Evidence: 13 CIs with recurring failures, worst: Impact Calculation (212
      incidents)]
    conditions: []
    violationMessage: This CI has recurring failures. Consider problem investigation before further changes.
    satisfiedMessage: No recurring failure pattern detected for this CI.
  - id: servicenow-live:discovered:failed_changes_on_ci
    name: Recent Failed Changes on CI (Discovered)
    domain: servicenow-live
    appliesTo:
      - change_request
    relevantActions:
      - approve
      - implement
    severity: block
    status: candidate
    description: >-
      Found 4 failed change(s). Affected CIs: cartservice/ecommerce/CloudObs, Lin-RPRO-AZURE-2022-9. CIs with recent
      failures are in a fragile state. [Evidence: 4 failed changes on 2 CI(s)]
    conditions: []
    violationMessage: Recent failed change on this CI. Review failure before approving new changes.
    satisfiedMessage: No recent failed changes on this CI.
  - id: servicenow-live:discovered:after_hours_change
    name: After-Hours Change Risk (Discovered)
    domain: servicenow-live
    appliesTo:
      - change_request
    relevantActions:
      - implement
      - approve
    severity: warn
    status: candidate
    description: >-
      Found 18 scheduled normal change(s) without approval. Normal changes require CAB or peer review before
      implementation. [Evidence: 18 unapproved normal changes scheduled]
    conditions: []
    violationMessage: Unapproved normal change detected. Route through change approval before implementation.
    satisfiedMessage: All scheduled changes have proper approval.
