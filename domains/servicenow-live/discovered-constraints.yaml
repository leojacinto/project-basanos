constraints:
  - id: discovered:change_freeze
    name: Active Change Freeze (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - resolve
      - close
      - auto_resolve
    severity: block
    description: >-
      Found 1 recent change requests. Incident resolution during active change windows should be blocked. [Evidence: 1
      change requests found in recent history]
    conditions:
      - field: change_freeze_active
        operator: eq
        value: true
    violationMessage: An active change freeze is in effect. Escalate to change management.
    satisfiedMessage: No active change freeze detected.
  - id: discovered:p1_reassignment
    name: P1 Reassignment Caution (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - reassign
    severity: warn
    description: >-
      67% of active P1 incidents have been reassigned. P1 reassignment disrupts war rooms and escalation chains.
      [Evidence: 3 active P1s, 2 reassigned (67% rate)]
    conditions:
      - field: priority
        operator: eq
        value: P1
    violationMessage: This is a P1 incident. Confirm with incident commander before reassigning.
    satisfiedMessage: Standard reassignment procedures apply.
  - id: discovered:sla_breach
    name: SLA Breach Review (Discovered)
    domain: itsm
    appliesTo:
      - incident
    relevantActions:
      - close
    severity: warn
    description: >-
      Found 2 breached SLA records. Incidents with breached SLAs should be reviewed before closure. [Evidence: 2
      breached SLA records found]
    conditions:
      - field: sla_breached
        operator: eq
        value: true
      - field: sla_has_penalty
        operator: eq
        value: true
    violationMessage: This incident breached an SLA. Review required before closing.
    satisfiedMessage: No SLA breach detected.
